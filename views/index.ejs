<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script type="text/javascript"
src="//media.twiliocdn.com/sdk/js/client/v1.3/twilio.min.js"></script>
    <script src="https://media.twiliocdn.com/sdk/js/common/v0.1/twilio-common.min.js"></script>
    <script src="https://media.twiliocdn.com/sdk/rtc/js/ip-messaging/v0.10/twilio-ip-messaging.min.js"></script>
    <script>
      var tc = {};

      tc.accessManager = new Twilio.AccessManager('eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImN0eSI6InR3aWxpby1mcGE7dj0xIn0.eyJqdGkiOiJTSzJiOTdhMTFjN2UzMjZiN2VkMDU4NjU0MDBhN2NiZTEwLTE0NjExMTI1OTgiLCJncmFudHMiOnsiaWRlbnRpdHkiOiI1NzE2Y2VmYzRiY2ViOTBjMmI1ODQyYTEiLCJpcF9tZXNzYWdpbmciOnsic2VydmljZV9zaWQiOiJJU2E4MTE5YzBlOGE4ZDQ0ZmNiZmYxODViOWU0NDQxNDk4IiwiZW5kcG9pbnRfaWQiOiJIQUFTOjU3MTZjZWZjNGJjZWI5MGMyYjU4NDJhMSJ9fSwiaWF0IjoxNDYxMTEyNTk4LCJleHAiOjE0NjExMTYxOTgsImlzcyI6IlNLMmI5N2ExMWM3ZTMyNmI3ZWQwNTg2NTQwMGE3Y2JlMTAiLCJzdWIiOiJBQ2JjNWVlMzYwOTQ1OTQ5MzU2ODdiZWQyY2FlNDI4NGE1In0.SMHxIpI3oMls8NuNcXZqCqWfY-1xgdeHXUJJOGS0d2k');
      tc.messagingClient = new Twilio.IPMessaging.Client(tc.accessManager);

      /*tc.messagingClient.getChannels().then(function(channels) {
        console.log('Channels:\n');
        for(var i = 0; i < channels.length; i++) {
          console.log('Channel: ' + channels[i].sid);
        }
      });*/

      tc.messagingClient.getChannelBySid('CH1238066ac096460d94d888d1af1ce0be').then(function(channel) {
        channel.join().then(function(joinedChannel) {
          console.log('Joined channel ' + joinedChannel.friendlyName);
          joinedChannel.sendMessage("The first test message for HAAS from client!");
        });
      });
    </script>
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Welcome to <%= title %></p>
  </body>
</html>
